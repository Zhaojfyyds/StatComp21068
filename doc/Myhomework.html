<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Junfeng Zhao" />

<meta name="date" content="2021-12-17" />

<title>homework</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Junfeng Zhao</h4>
<h4 class="date">2021-12-17</h4>



<div id="question" class="section level2">
<h2>Question</h2>
<p>Go through “R for Beginners” if you are not familiar with R programming.</p>
<p>Use knitr to produce at least 3 examples (texts, figures,tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>example 1：</p>
<p><span class="math display">\[y_i=\beta_0+\beta_1x_i\]</span></p>
<p>example 2:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>example 3:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>;</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>x<span class="sc">^</span><span class="dv">2</span>;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>lmr<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x);</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>co<span class="ot">&lt;-</span><span class="fu">summary</span>(lmr)<span class="sc">$</span>coefficients;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(co);</span></code></pre></div>
<pre><code>##             Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)      -22  5.5497748 -3.964125 4.152962e-03
## x                 11  0.8944272 12.298374 1.777539e-06</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(co,<span class="at">digits=</span><span class="dv">2</span>,<span class="at">align =</span> <span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="center">-22</td>
<td align="center">5.55</td>
<td align="center">-3.96</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="center">11</td>
<td align="center">0.89</td>
<td align="center">12.30</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>example 4:</p>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>3.4: The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{σ^2}e^{-x^2/(2σ^2)},x\geq0,σ&gt;0.\]</span> Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ(check the histogram).</p>
<p>3.11： Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0,1) and N(3,1) distributions with mixing probabilities p1 and p2=1−p1.Graph the histogram of the sample with density superimposed, for p1 = 0.75. Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
<p>3.20： A compound Poisson process is a stochastic process <span class="math inline">\({X(t),t≥0}\)</span> that can be represented as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i,t\geq0\)</span>, where <span class="math inline">\({N(t),t≥0}\)</span> is a Poisson process and Y1, Y2,… are iid and independent of {N(t), t≥0}.Write a program to simulate a compound Poisson(λ)–Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)] = λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) = λtE[Y_1^2]\)</span>.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.4:</p>
<p>The algorithm to generate random samples from a Rayleigh(σ) distribution.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Rayleigh<span class="ot">&lt;-</span> <span class="cf">function</span>(n,σ){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="sc">-</span><span class="dv">2</span>)<span class="sc">*</span>(σ<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (r)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>when <span class="math inline">\(\sigma\)</span>=1</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>σ<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">Rayleigh</span>(<span class="dv">1000</span>,σ)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;σ=1&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">01</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(y<span class="sc">/</span>σ<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>σ<span class="sc">^</span><span class="dv">2</span>)) )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(\sigma\)</span>=2</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>σ<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">Rayleigh</span>(<span class="dv">1000</span>,σ)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;σ=2&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">01</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,(y<span class="sc">/</span>σ<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>σ<span class="sc">^</span><span class="dv">2</span>)) )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.11:</p>
<p>Develop an algorithm to generate a random sample of size 1000 from a normal location mixture.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>loc.mix <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p, mu1, mu2, Sigma) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> n <span class="sc">-</span> n1</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n1, <span class="at">mu =</span> mu1, Sigma)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n2, <span class="at">mu =</span> mu2, Sigma)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x1, x2) </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(X[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n), ]) </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>when p=0.75:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">loc.mix</span>(<span class="dv">1000</span>, .<span class="dv">75</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">Sigma =</span><span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">range</span>(x) <span class="sc">*</span> <span class="fl">1.2</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>then,repeat p=0.05,p=0.25,p=0.5,p=0.95:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span> <span class="fu">loc.mix</span>(<span class="dv">1000</span>, .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">Sigma =</span><span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span> <span class="fu">loc.mix</span>(<span class="dv">1000</span>, .<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">Sigma =</span><span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x3<span class="ot">&lt;-</span> <span class="fu">loc.mix</span>(<span class="dv">1000</span>, .<span class="dv">95</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">Sigma =</span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>x4<span class="ot">&lt;-</span> <span class="fu">loc.mix</span>(<span class="dv">1000</span>, .<span class="dv">05</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="at">Sigma =</span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2, 2))</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x1);<span class="fu">hist</span>(x2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x3);<span class="fu">hist</span>(x4)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAACsAAFUAKysAK1UAK4AAVYAAVaorAAArACsrKwArK1UrK4ArVYArVaorgKorgNRVAABVACtVKwBVKytVVVVVgKpVgNRVqtRVqv+AKwCAVQCAVSuAgFWAgKqAqoCAqtSAqv+A1NSA1P+qVQCqVSuqVYCqgFWq1NSq1P+q/6qq///T09PUgCvUgFXUqlXUqoDU1KrU1NTU/6rU/9TU////qlX/1ID/1Kr//6r//9T///+PeiwiAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJC0lEQVR4nO2da2PbNBiFndHS0HFp1gFrBwyoBxTwLkDdNv7//wtdrMRLoxzZluzXznk+tI2rvI6eyLrYspxV5CDZ2B9AOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgoaD1dXZ6Z3+fbV40/v3bX7F3+HaZZV97PspZx6CjCXq4fBZbUJkpLvb9p8jEC3pCnkUXVGSLm73/uF/KF1S/eHeeZYuvbrUfhVb04WWWffadKVzrt1l2cmPMqby+ucye3VYfLlW65yrfj6vs7MN5tnhVvVuqVNvdbAKYkFaRMqKCqH2aL0H9noqgIstqMU5QvUUnNPnIFufbzad3pf23yrYSZDl3ai3bAA1BeuuF/nFlX5xcChXkqAXpUnBXvTcVhT3E1FdtvV2YKuTsbp07b6e31T/qXZ/f6UQXRtCFfm/2qk5vaAZoHGLqjYs3S/sFldniV6mV9I4glZuTP+r/WkF1TZTbQqX/ViKsoKs64cffz3UAtV1l1/40xpphKndcbg49Xe3Yl+otV2JbsR1BdoutcfK6ljBfss6a+/uTvK5/cAF06avqn1tBzQCfVtK5a9Fyu3eZgnbroIdLW6X8Unuw+TVH15X7uylIGz356ePKK6gZ4FNB5dK+KusvYhqCVPfnx3NXpQaUIGvi0S/IW4JMYT11bVvm7SFBRugorl9vaxx/HVR//boqcpX0HkHeOqgwzd3FxASp/H5jjjPT8Ojc+FsxV4JO7x6u/XWQrxXTm/9dbV5P5hB7u+nWmHHBoX7Qpg46WEk3+0ENQbqVvzHGN6+nIah6r2ug57dV3W2+rTvC39s3qE1f3j5pxU5+LtQmn6BGgK2g0h5QuessyBTUkXx32D8uggTl5lyFKh1dv+wkCBJUj7t8Q/KRECSoeni5rMf6gpAkSCQUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB4gjazAOcn+/IOaKgYcMJYFKCshEO5WkJ+ttBQfujUxCITkEgOgWB6BQEolMQiE5BIDoFgegUBKKLF+Tu3/IumnDkggp3m1bpu7/xuAWtr7f3+Xnu6TpuQY8rd7N/VXoOssEEDTau38R3d6AfQFIJGqwsNeIX8Nbpwq0XMX4dNIagCjtyS7B47yqduyCrqMfKRzMXpO8avVJVTffbjucsSB8+1oyviXpc6cOvFNFRHF7Q4wrebWwEmfar0eB7wsVk26SPfYgBtKBazaDNfLZHyxiCcpVpb/ut0YLul0bQzlGYttsmRFBuCsXjyt9dPO4S5KoVXw1duV7QWeWq60PhYiJDkBtHFAd7QY8ru+6M70CcsaB6HHG/7LZQ05NwEREiqLGyXpRw8ZAiSGC4OigFgaAyBMHzzdvlVP2p5iwox4P49TVKM2NB3q5Nk/U1OOs4gqDEJ1+fdBQPU2aHU40gKHFZanQUY6ytNmNBsHC0DBcRGYI2TVSvpeZnLEhkuDooBYGgQgSZ5dDzXmPVWQsqFzeFXpd/aqP5oQTp80H6POHh80HB4WIiQ5DuKGpBB84otgkXExmCXAnKey1WPGNBdR1U9OsuzlmQ7SpO74zicIIEhquDUhAIKkIQx2Kene+87tbKj3npeehDLO91WugIBLGjuLPz3Q0cauzsfOf1odkdHcJFQYYgOIG1XbiYyBAkMlwdlIJAUBGCAq4rtwkXExmC6ss+Ux7NJ+muNs4HWTO+2Yctw8UkVFCSsrQ9xF7YEx0T7iimFeRK0ITPKKYVpM8oqp9FvzNmET9ao0qRIci2Yz0fnxdT0NOcjyxIWDgKQqHECRJ26VmcIGmXnqUJCrr0POTKC9IEhVx6HnTlBWmCAi49D3vfvDRBAZeeh115QZwgfOn5yEtQAIOuvCBNUKN4+Em/8sKeEZgQQWEz7YPDdQ5wKOcjV9J9VqSIdi5PrqCAyQtDrLwgV1AAQ6y8MHlBqe+bjyMo4tl7GyKshvavvLATrs/niSIoYlFqCIIN/XRK0GiC0q+8MGlB1QArL0xdUFi4PgEoCASgIBBAqqAYUzuq+QqKRsdwB8fwFATKDQVREH4bBe1PHVTzHLOgtvltLaj/uH4EQd0n/rQXtN2UMkeRw3XP+awFxbhcMW9BEXJOQZMX1GP6y1EI6jP95RgEBU9e2Nf9GFtQ1x5Ru8s+vukvO3vPRJNOUEAJmh+Rp7/Mj3YFLs59m5Micj9ofiQRNG4ljJAgKG66UZJ1TB43KAXFSUdBEpN1TB43KAXFSUdBEpN1TB43KAXFSTc/QXOCggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAVIIMpNk4KXXMugJA2GxDCHL0+lHpbZbzTeBoPW1yniBPodeU66EhsJi2YAB13tLlaTlescJBNnbWsG61HYiBFz+PCiWwayfBdLYnbZbMTtZHQRKR3jOcSxDcfoaCrr/ov0aiMkEgaeS2s8auNpDwBNOVTxcB5XP/lyF1miOVILQBBlbKEKKRtBkG33wYEGFnlzZ8mmXiQSVIXV0oCAYq6oCH9tklxltt0hJGkH4Ow8/xEIma5loAYLM7uq1EQKJK6iwnZYC5ym4kg6IZferATm330e7qjpFCQpZtDuwmW+zADguQXYW6uiH2P0ypJ0I6yiGxbIE9KR1VdXy5u4EguryjjJfhAw1AmMZQoYaZfDAxcHBKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEmIqgfo+g7sFEBIXM8U3DNASFzPFNhGRBev6ZfQZMyBzfREgW5J5sGjbHNxGSBel5zS9uQuf4JkK0oCo3M4DD5vgmQragUk/hDJzjmwjRgtbX36p6OnCObyJECypO/3NTUlmC9qCnNbtJzRS0h9zMaj7b/D0KkgWJgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAvwPWFA0KioRxmIAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p>Obviously, the p may be 0.5.</p>
<p>3.20:</p>
<p>Write a program to simulate a compound Poisson(λ)–Gamma process (Y has a Gamma distribution):</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>PG<span class="ot">&lt;-</span><span class="cf">function</span>(n,r,beta,lambda,t){   </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>     Y<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>           k<span class="ot">=</span><span class="fu">rpois</span>(<span class="dv">1</span>,t<span class="sc">*</span>lambda)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>           X<span class="ot">&lt;-</span><span class="fu">rgamma</span>(k,<span class="at">shape=</span>r,<span class="at">rate=</span>beta)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>           Y[i,]<span class="ot">&lt;-</span><span class="fu">sum</span>(X)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>     }</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(Y)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values:so t=10</p>
<p>when <span class="math inline">\(\gamma=\beta=\lambda=1\)</span></p>
<p>the theoretical values:</p>
<p><span class="math inline">\(E[X(t)] = λtE[Y_1]=λt\frac{\gamma}{\beta}=10\)</span></p>
<p><span class="math inline">\(Var(X(t)) = λtE[Y_1^2]=λt\frac{\gamma(1+\gamma)}{\beta^2}=20\)</span></p>
<p>the estimated values:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">PG</span>(<span class="dv">1000</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x);<span class="fu">var</span>(x)</span></code></pre></div>
<pre><code>## [1] 10.16818</code></pre>
<pre><code>##          [,1]
## [1,] 21.03504</code></pre>
<p>when <span class="math inline">\(\gamma=\beta=\lambda=2\)</span></p>
<p>the theoretical values:</p>
<p><span class="math inline">\(E[X(t)] =λtE[Y_1]=λt\frac{\gamma}{\beta}=20\)</span></p>
<p><span class="math inline">\(Var(X(t)) = λtE[Y_1^2]=λt\frac{\gamma(1+\gamma)}{\beta^2}=30\)</span></p>
<p>the estimated values:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">PG</span>(<span class="dv">1000</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">10</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x);<span class="fu">var</span>(x)</span></code></pre></div>
<pre><code>## [1] 19.94785</code></pre>
<pre><code>##          [,1]
## [1,] 27.66391</code></pre>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>5.4</p>
<p>Write a function to compute a Monte Carlo estimate of the <span class="math inline">\(Beta(3,3)\)</span> cdf,and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x = 0.1, 0.2,..., 0.9.\)</span> Compare the estimates with the values returned by the pbeta function in R.</p>
<p>5.9</p>
<p>The Rayleigh density is<span class="math display">\[f(x)=\frac{x}{σ^2}e^{-x^2/(2σ^2)}, x\geq0,σ&gt;0\]</span> Implement a function to generate samples from a Rayleigh(σ) distribution,using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(X+X&#39;\over2\)</span> compared with <span class="math inline">\(X1+X2\over2\)</span> for independent <span class="math inline">\(X1, X2\)</span>?</p>
<p>5.13</p>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,∞)\)</span> and are ‘close’ to <span class="math display">\[g(x) = \frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}, x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}{\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}}dx\]</span>by importance sampling? Explain.</p>
<p>5.14</p>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_{1}^{\infty}{\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}}dx\]</span> by importance sampling.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>5.4:</p>
<p>The <span class="math inline">\(beta(3,3)\)</span> cdf is <span class="math display">\[F(x)=\int_{0}^{x}{30t^2(1-t)^2}dt\]</span> Making the substitution <span class="math inline">\(y=t/x\)</span>, we have <span class="math inline">\(dt=xdy\)</span> and <span class="math display">\[\theta=\int_{0}^{1}{30x^3y^2(1-xy)^2}dy\]</span> Thus, <span class="math inline">\(\theta=E_Y[30x^3y^2(1-xy)^2]\)</span>, where the random variable Y has the Uniform(0,1) distribution.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(.<span class="dv">1</span>,.<span class="dv">9</span>,<span class="at">length=</span><span class="dv">9</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cdf<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      g<span class="ot">&lt;-</span><span class="dv">30</span><span class="sc">*</span>x[i]<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x[i]<span class="sc">*</span>u)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      cdf[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(g)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>Phi<span class="ot">&lt;-</span><span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">rbind</span>(x,cdf,Phi),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##      [,1]  [,2]  [,3]  [,4] [,5]  [,6]  [,7]  [,8]  [,9]
## x   0.100 0.200 0.300 0.400  0.5 0.600 0.700 0.800 0.900
## cdf 0.009 0.058 0.163 0.317  0.5 0.684 0.839 0.946 0.997
## Phi 0.009 0.058 0.163 0.317  0.5 0.683 0.837 0.942 0.991</code></pre>
<p>Results are shown compared with the value of the normal cdf function pnorm. The Monte Carlo estimates appear to be very close to the pnorm values.</p>
<p>5.9:</p>
<p>Derive the inverse function <span class="math display">\[F_X^{-1}(u)=\sqrt{-2\sigma^2\ln(1-u)}\]</span> and U ∼ Uniform(0,1), Note that if U is uniformly distributed on (0, 1) then 1−U has the same distribution as U, but U and 1 − U are negatively correlated. Then in <span class="math display">\[F_X^{-1}(u)=\sqrt{-2\sigma^2\ln(1-u)}\]</span> has the same distribution as<span class="math display">\[F_X^{-1}(1-u)=\sqrt{-2\sigma^2\ln(u)}\]</span> Implement a function to generate samples from a Rayleigh(σ) distribution, using antithetic variables.</p>
<p>then,we can get <span class="math inline">\(X,X&#39;\)</span>,where <span class="math inline">\(\sigma=1\)</span>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Rayleigh<span class="ot">&lt;-</span> <span class="cf">function</span>(n,σ){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        u<span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        X_a<span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="sc">-</span><span class="dv">2</span>)<span class="sc">*</span>(σ<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(u))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        X<span class="ot">&lt;-</span><span class="fu">sqrt</span>((<span class="sc">-</span><span class="dv">2</span>)<span class="sc">*</span>(σ<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(X,X_a))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">Rayleigh</span>(<span class="dv">100000</span>,<span class="dv">1</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">unlist</span>(Y),<span class="dv">100000</span>,<span class="dv">2</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span>Z[,<span class="dv">1</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>X_a<span class="ot">&lt;-</span>Z[,<span class="dv">2</span>]</span></code></pre></div>
<p>and derive <span class="math inline">\(X_1 ,X_2\)</span>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Rayleigh2<span class="ot">&lt;-</span> <span class="cf">function</span>(n,σ){</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="sc">-</span><span class="dv">2</span>)<span class="sc">*</span>(σ<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(n)))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span> (t)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">&lt;-</span><span class="fu">Rayleigh2</span>(<span class="dv">100000</span>,<span class="dv">1</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>X2<span class="ot">&lt;-</span><span class="fu">Rayleigh2</span>(<span class="dv">100000</span>,<span class="dv">1</span>)</span></code></pre></div>
<p>the percent reduction in variance of <span class="math inline">\(X+X&#39;\over2\)</span> compared with <span class="math inline">\(X1+X2\over2\)</span> for independent <span class="math inline">\(X1, X2\)</span> :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Y1<span class="ot">&lt;-</span><span class="fu">var</span>((X1<span class="sc">+</span>X2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Y2<span class="ot">&lt;-</span><span class="fu">var</span>((X<span class="sc">+</span>X_a)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>((Y1<span class="sc">-</span>Y2)<span class="sc">/</span>Y1)</span></code></pre></div>
<pre><code>## [1] 0.94738</code></pre>
<p>5.13:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)}  </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(m,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>theta.hat1<span class="ot">&lt;-</span><span class="fu">mean</span>(g1)                                         </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rgamma</span>(m,<span class="fl">4.5</span>,<span class="fl">2.5</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>g2<span class="ot">&lt;-</span><span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="fl">4.5</span>,<span class="fl">2.5</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>theta.hat2<span class="ot">&lt;-</span><span class="fu">mean</span>(g2)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(theta.hat1,theta.hat2))                                </span></code></pre></div>
<pre><code>## [1] 0.4015175 0.4006390</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(g,<span class="dv">1</span>,<span class="cn">Inf</span>)                                                   </span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">sd</span>(g1),<span class="fu">sd</span>(g2)))                                        </span></code></pre></div>
<pre><code>## [1] 0.3027036 0.2146818</code></pre>
<p>The second important function is better, the estimate is closer to the theoretical value with a smaller variance.</p>
<p>5.14:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x){x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)}  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rgamma</span>(m,<span class="fl">4.5</span>,<span class="fl">2.5</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>f1<span class="ot">&lt;-</span><span class="fu">f</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="fl">4.5</span>,<span class="fl">2.5</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>theta.hat1<span class="ot">&lt;-</span><span class="fu">mean</span>(f1)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(theta.hat1,<span class="fu">sd</span>(f1)))                              </span></code></pre></div>
<pre><code>## [1] 0.4031241 0.2130849</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(f,<span class="dv">1</span>,<span class="cn">Inf</span>)                                                   </span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<p>The estimated value is 0.4031241</p>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p><strong>6.5.</strong> Suppose a <span class="math inline">\(95\%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><strong>6.A</strong> Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0 : \mu = \mu_0~vs~H_1 : \mu \not= \mu_0\)</span>, where µ0 is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
<p><strong>3.</strong>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.</p>
<p>(1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?</p>
<p>(3)Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p><strong>6.5</strong></p>
<p>The t-interval for the mean of a population is: <span class="math display">\[(\bar{x}-t_{\frac{\alpha}{2}}(n-1)\cdot\frac{S}{\sqrt{n}},\bar{x}+t_{\frac{\alpha}{2}}(n-1)\cdot\frac{S}{\sqrt{n}})\]</span> where <span class="math inline">\(S\)</span> is the sample standard deviation,<span class="math inline">\(\bar{x}\)</span> is the mean of sample, <span class="math inline">\(t_{\frac{\alpha}{2}}(n-1)\)</span> is the upper <span class="math inline">\(\frac{\alpha}{2}\)</span>-quantile of <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(df=n-1\)</span>.</p>
<p>The population is known that <span class="math inline">\(X\sim \chi^2(2)\)</span> and <span class="math inline">\(\theta=E(X)=2\)</span>. Therefore, the empirical estimate of the confidence level is <span class="math display">\[\hat{P}=\frac{1}{m} \sum\limits_{j=1}^m I(\hat{\theta}_1^{(j)}&lt;\theta&lt;\hat{\theta}_2^{(j)})\]</span> where <span class="math inline">\((\hat{\theta}_1^{(j)},\hat{\theta}_2^{(j)})\)</span> is the confidence interval <span class="math inline">\(C_j\)</span> for the <span class="math inline">\(j^{th}\)</span> sample.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1000</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.05</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>CI<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">1000</span>,<span class="at">expr=</span>{</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>      CI_1<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>      CI_2<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">c</span>(CI_1,CI_2))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(CI[<span class="dv">1</span>,]<span class="sc">&lt;</span><span class="dv">2</span><span class="sc">&amp;</span>CI[<span class="dv">2</span>,]<span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.932</code></pre>
<p>The estimate of the coverage probability of the t-interval is 0.932,which is smaller than 0.95.However,compared with simulation results in Example 6.4,the t-interval should be more robust to departures from normality than the interval for variance.</p>
<p><strong>6.A</strong></p>
<p>knowing that <span class="math inline">\(X\sim \chi^2(2)\)</span> ,<span class="math inline">\(Y\sim U(0,2)\)</span> and <span class="math inline">\(Z\sim \exp(1)\)</span>,so <span class="math inline">\(\mu_0=E(X)=E(Y)=E(Z)=1\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span>;alpha<span class="ot">&lt;-</span> .<span class="dv">05</span>;mu0<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>p_1<span class="ot">&lt;-</span>p_2<span class="ot">&lt;-</span>p_3<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>ttest_1<span class="ot">&lt;-</span><span class="fu">t.test</span>(x,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">mu=</span>mu0)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>p_1[j]<span class="ot">&lt;-</span>ttest_1<span class="sc">$</span>p.value</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>ttest_2<span class="ot">&lt;-</span><span class="fu">t.test</span>(y,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">mu=</span>mu0)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>p_2[j]<span class="ot">&lt;-</span>ttest_2<span class="sc">$</span>p.value</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>ttest_3<span class="ot">&lt;-</span><span class="fu">t.test</span>(z,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">mu=</span>mu0)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>p_3[j]<span class="ot">&lt;-</span>ttest_3<span class="sc">$</span>p.value</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>p_1.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p_1<span class="sc">&lt;</span>alpha)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>p_2.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p_2<span class="sc">&lt;</span>alpha)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>p_3.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(p_3<span class="sc">&lt;</span>alpha)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p_1.hat,p_2.hat,p_3.hat))</span></code></pre></div>
<pre><code>## [1] 0.0992 0.0498 0.0831</code></pre>
<p>The t-test is robust to mild departures from normality.</p>
<p><strong>3.</strong></p>
<p>(1)the corresponding hypothesis test problem is</p>
<p><span class="math display">\[H_0:power_1 = power_2 \qquad H_1:power_1 \ne power_2\]</span></p>
<p>(2)I think we should use <strong>paired-t test</strong>.</p>
<p>Because firstly, the two methods are independent,so Z-test can not be used. Secondly, since the sample of two methods are not independent, we can not use two-sample t test as well. thirdly, we just have a property, which are not suitable for McNemar test.</p>
<p>(3)It needs to know the relationship between the two methods.</p>
</div>
<div id="exercise-6.c" class="section level2">
<h2>Exercise 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span>and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d} = E [ (X − \mu)^T \Sigma^{-1}(Y − \mu)]^ 3 .\]</span> Under normality, <span class="math inline">\(\beta_{1,d} = 0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d} =\frac{1}{n^2} \displaystyle \sum^{n}_{i,j=1}{((X_i − \bar{X})^T\hat{\Sigma}^{−1}(X_j − \bar{X}))^3},\tag{6.5}\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
<div id="solution" class="section level3">
<h3>Solution</h3>
<p><strong>Example 6.8</strong></p>
<p>Let d is 3.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21068</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">9</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>cv<span class="ot">&lt;-</span><span class="fu">qchisq</span>(<span class="fl">0.95</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)  <span class="co">#卡方分布的下0.95分位点</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>sk<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    n<span class="ot">&lt;-</span><span class="fu">nrow</span>(x)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    d<span class="ot">&lt;-</span><span class="fu">ncol</span>(x)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    xcen<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d){</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>       xcen[,i]<span class="ot">&lt;-</span>x[,i]<span class="sc">-</span><span class="fu">mean</span>(x[,i])</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    Sigma.hat<span class="ot">&lt;-</span><span class="fu">t</span>(xcen)<span class="sc">%*%</span>xcen<span class="sc">/</span>n    <span class="co">#Sigma的估计</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>xcen<span class="sc">%*%</span><span class="fu">solve</span>(Sigma.hat)<span class="sc">%*%</span><span class="fu">t</span>(xcen)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    z<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">colSums</span>(y<span class="sc">^</span>{<span class="dv">3</span>}))<span class="sc">/</span>(n<span class="sc">*</span>n)   <span class="co">#b1,d 的值</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>    test<span class="ot">&lt;-</span>n<span class="sc">*</span>z<span class="sc">/</span><span class="dv">6</span>                    <span class="co">#nb/6 </span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(test)</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>}                                   </span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>                                     </span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>p.reject<span class="ot">=</span><span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)) {</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>    sktests<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>       x<span class="ot">=</span><span class="fu">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>       sktests[j]<span class="ot">&lt;-</span><span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x))<span class="sc">&gt;=</span>cv)  <span class="co">#检验决策 比较二者大小</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    p.reject[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(sktests)  </span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(n,cv,p.reject)</span></code></pre></div>
<pre><code>##              [,1]     [,2]     [,3]     [,4]      [,5]      [,6]
## n        10.00000 20.00000 30.00000 50.00000 100.00000 500.00000
## cv       18.30704 18.30704 18.30704 18.30704  18.30704  18.30704
## p.reject  0.00100  0.02100  0.03800  0.04400   0.04500   0.04400</code></pre>
<p>Mardia’s multivariate skewness test also has the problem that when the sample size is small, it tends to underestimates the Type-1 error.</p>
<p><strong>Example 6.10</strong></p>
<p>Choose <span class="math inline">\(d=2\)</span> and calculate the power with different <span class="math inline">\(\epsilon\)</span> .The contaminated multivariate normal distribution is denoted by:<span class="math display">\[(1-\epsilon)N(0,0;1,1;0)+\epsilon N(0,0;100,100;0),~~~~0\le \epsilon \le 1\]</span></p>
<p>In this case the significance level <span class="math inline">\(\alpha=0.1\)</span> and the sample size <span class="math inline">\(n=30\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21068</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span>;d<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span>;mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, .<span class="dv">15</span>, .<span class="dv">01</span>), <span class="fu">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, .<span class="dv">05</span>))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(epsilon)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(.<span class="dv">9</span>,d<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(d<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,d)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) { </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>   e <span class="ot">&lt;-</span> epsilon[j]</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>   sktests <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) { </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>      sigma <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>e, e))  </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>         x[k,]<span class="ot">=</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>, mu, sigma[k]<span class="sc">*</span><span class="fu">diag</span>(<span class="dv">2</span>))</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>      }   </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>         sktests[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">abs</span>(<span class="fu">sk</span>(x))<span class="sc">&gt;=</span> cv )</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(sktests)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsilon, pwr, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="fu">bquote</span>(epsilon), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pwr <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>pwr) <span class="sc">/</span> m) </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsilon, pwr<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the result and the figure we can easily find that when the epsilon value is close to 0 or 1, the empirical power is close to 0.1. Also, the power is close to 1 when epsilon is about 0.2. As epsilon value increasing, the empirical power increases steadily and decreases slowly.</p>
</div>
</div>
<div id="exercise-7.7" class="section level2">
<h2>Exercise 7.7</h2>
<p>Refer to Exercise <span class="math inline">\(7.6\)</span>. Efron and Tibshirani discuss the following example [84,Ch.7]. The five-dimensional scores data have a <span class="math inline">\(5×5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>,with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\lambda_2&gt;\lambda_3&gt;\lambda_4&gt;\lambda_5\)</span>. In principal components analysis, <span class="math display">\[\theta = \frac{\lambda_1}{\sum_{j=1}^{5}{\lambda_j}} \]</span> measures the proportion of variance explained by the first principal compo￾nent. Let <span class="math inline">\(\hat{\lambda}_1&gt;\hat{\lambda}_2&gt;\hat{\lambda}_3&gt;\hat{\lambda}_4&gt;\hat{\lambda}_5\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[\hat{\theta} = \frac{\hat{\lambda}_1}{\sum_{j=1}^{5}{\hat{\lambda}_j}}\]</span> <span class="math display">\[Bootstrap ~~and ~~Jackknife \tag{213} \]</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div id="solution-1" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">eigen</span>(X)<span class="sc">$</span>value</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> Y[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(Y)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>scor.b <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">88</span>, <span class="dv">5</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>theta.boot <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> T)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  scor.b[,<span class="dv">1</span>] <span class="ot">&lt;-</span> scor<span class="sc">$</span>mec[i]</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  scor.b[,<span class="dv">2</span>] <span class="ot">&lt;-</span> scor<span class="sc">$</span>vec[i]</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  scor.b[,<span class="dv">3</span>] <span class="ot">&lt;-</span> scor<span class="sc">$</span>alg[i]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  scor.b[,<span class="dv">4</span>] <span class="ot">&lt;-</span> scor<span class="sc">$</span>ana[i]</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  scor.b[,<span class="dv">5</span>] <span class="ot">&lt;-</span> scor<span class="sc">$</span>sta[i]</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor.b))<span class="sc">$</span>value</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  theta.boot[b] <span class="ot">&lt;-</span> z[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(z)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>bias.boot <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta.boot) <span class="sc">-</span> theta.hat</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>se.boot <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta.boot)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(bias.boot,se.boot))</span></code></pre></div>
<pre><code>## [1] 0.004835489 0.049610082</code></pre>
</div>
</div>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p>Refer to Exercise <span class="math inline">\(7.7\)</span>. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div id="solution-2" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">eigen</span>(X)<span class="sc">$</span>value</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> Y[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(Y)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>   Z <span class="ot">&lt;-</span>   <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>i,]))<span class="sc">$</span>value</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>   theta.jack[i] <span class="ot">&lt;-</span> Z[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(Z)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(bias.jack,se.jack))</span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
</div>
<div id="exercise-7.9" class="section level2">
<h2>Exercise 7.9</h2>
<p>Refer to Exercise <span class="math inline">\(7.7\)</span>. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div id="solution-3" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor,<span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>theta.b <span class="ot">&lt;-</span> <span class="cf">function</span>(data,indices) {</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> data[indices,]</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(a))<span class="sc">$</span>value</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  b[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(b)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> scor, <span class="at">statistic =</span> theta.b, <span class="at">R=</span><span class="dv">200</span>)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(boot.obj, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percentile CI:&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>,<span class="fu">paste</span>(ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">collapse=</span><span class="st">&quot;, &quot;</span>),<span class="st">&quot;)&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Percentile CI: (0.514731764997507, 0.719744777411498)</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa CI:&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>,<span class="fu">paste</span>(ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>], <span class="at">collapse=</span><span class="st">&quot;, &quot;</span>),<span class="st">&quot;)&quot;</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>) </span></code></pre></div>
<pre><code>## BCa CI: (0.513085631931562, 0.71524181641282)</code></pre>
</div>
</div>
<div id="exercise-7.b" class="section level2">
<h2>Exercise 7.B</h2>
<p>Repeat Project <span class="math inline">\(7.A\)</span> for the sample skewness statistic. Compare the coverage rates for normal populations (skewness <span class="math inline">\(0\)</span>) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
<div id="solution-4" class="section level3">
<h3>Solution</h3>
<p><strong>normal population</strong></p>
<p>We set the normal populations is <span class="math inline">\(N(0,1).\)</span>The skewness is <span class="math inline">\(0\)</span>.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>boot.sk <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>     d <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>     n <span class="ot">&lt;-</span> <span class="fu">length</span>(d)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>     e <span class="ot">&lt;-</span> <span class="fu">sum</span>((d<span class="sc">-</span><span class="fu">mean</span>(d))<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>n</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>     f <span class="ot">&lt;-</span> (<span class="fu">sum</span>((d<span class="sc">-</span><span class="fu">mean</span>(d))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n)<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(e<span class="sc">/</span>f)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>   U <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>   de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> U, <span class="at">statistic =</span> boot.sk, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>   ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>   ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>   ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>   ci.perc[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] </span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">distribution=</span><span class="fu">c</span>(<span class="st">&#39;norm&#39;</span>, <span class="st">&#39;basic&#39;</span>, <span class="st">&#39;perc&#39;</span>),</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_est=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="sc">&lt;=</span> sk <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>] <span class="sc">&gt;=</span> sk), </span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="sc">&lt;=</span> sk <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>] <span class="sc">&gt;=</span> sk),</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="sc">&lt;=</span> sk <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>] <span class="sc">&gt;=</span> sk)),</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_leftmiss=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="sc">&gt;</span> sk), <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="sc">&gt;</span> sk), <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="sc">&gt;</span> sk)),</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_rightmiss=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>] <span class="sc">&lt;</span> sk), <span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>] <span class="sc">&lt;</span> sk), <span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>] <span class="sc">&lt;</span> sk)))</span></code></pre></div>
<pre><code>##              [,1]    [,2]    [,3]   
## distribution &quot;norm&quot;  &quot;basic&quot; &quot;perc&quot; 
## ci_est       &quot;0.933&quot; &quot;0.926&quot; &quot;0.956&quot;
## ci_leftmiss  &quot;0.029&quot; &quot;0.031&quot; &quot;0.023&quot;
## ci_rightmiss &quot;0.038&quot; &quot;0.043&quot; &quot;0.021&quot;</code></pre>
<p><strong>chi square distribution </strong></p>
<p>The formula for skewness is <span class="math display">\[
\begin{aligned}
Skew(X) &amp;=E\left[\left(\frac{x-\mu}{\sigma}\right)^3\right]\\
        &amp;=\frac{EX^3-3\mu EX^2+3\mu^2EX-\mu^3}{\sigma^3}\\
        &amp;=\frac{EX^3-3\mu (EX^2-\mu EX)-\mu^3}{\sigma^3}\\
        &amp;=\frac{EX^3-3\mu \sigma^2-\mu^3}{\sigma^3}
\end{aligned}
\]</span> The density function of <span class="math inline">\(\chi^2(5)\)</span> is <span class="math display">\[f(x)=\frac{1}{3\sqrt{2\pi}}x^{3/2}e^{-x/2},\]</span>where <span class="math inline">\(\mu=EX=5\)</span>,<span class="math inline">\(\sigma^2=Var(X)=10\)</span>.</p>
<p>Then the <span class="math inline">\(EX^3\)</span> is <span class="math display">\[
\begin{aligned}
EX^3 &amp;=\int_{0}^{\infty}{\frac{1}{3\sqrt{2\pi}}x^{9/2}e^{-x/2}}{\rm d}x\\
     &amp;=\frac{1}{3\sqrt{2\pi}}\Gamma(\frac{11}{2})\\
     &amp;=315
\end{aligned}
\]</span> So,the skewness is <span class="math inline">\(\sqrt{1.6}\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>sk <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">1.6</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>boot.sk <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>     d <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>     n <span class="ot">&lt;-</span> <span class="fu">length</span>(d)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>     e <span class="ot">&lt;-</span> <span class="fu">sum</span>((d<span class="sc">-</span><span class="fu">mean</span>(d))<span class="sc">^</span><span class="dv">3</span>)<span class="sc">/</span>n</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>     f <span class="ot">&lt;-</span> (<span class="fu">sum</span>((d<span class="sc">-</span><span class="fu">mean</span>(d))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n)<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(e<span class="sc">/</span>f)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic <span class="ot">&lt;-</span> ci.perc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>   U <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">5</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>   de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> U, <span class="at">statistic =</span> boot.sk, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>   ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>   ci.norm[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>   ci.basic[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>   ci.perc[i,] <span class="ot">&lt;-</span> ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] </span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">distribution=</span><span class="fu">c</span>(<span class="st">&#39;norm&#39;</span>, <span class="st">&#39;basic&#39;</span>, <span class="st">&#39;perc&#39;</span>),</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_est=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="sc">&lt;=</span> sk <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>] <span class="sc">&gt;=</span> sk), </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="sc">&lt;=</span> sk <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>] <span class="sc">&gt;=</span> sk),</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="sc">&lt;=</span> sk <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>] <span class="sc">&gt;=</span> sk)),</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_leftmiss=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>] <span class="sc">&gt;</span> sk), <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>] <span class="sc">&gt;</span> sk), <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>] <span class="sc">&gt;</span> sk)),</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">ci_rightmiss=</span><span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>] <span class="sc">&lt;</span> sk), <span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>] <span class="sc">&lt;</span> sk), <span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>] <span class="sc">&lt;</span> sk)))</span></code></pre></div>
<pre><code>##              [,1]    [,2]    [,3]   
## distribution &quot;norm&quot;  &quot;basic&quot; &quot;perc&quot; 
## ci_est       &quot;0.797&quot; &quot;0.776&quot; &quot;0.782&quot;
## ci_leftmiss  &quot;0.02&quot;  &quot;0.034&quot; &quot;0.001&quot;
## ci_rightmiss &quot;0.183&quot; &quot;0.19&quot;  &quot;0.217&quot;</code></pre>
</div>
</div>
<div id="exercise-8.2" class="section level2">
<h2>Exercise 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for independence as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = “spearman”. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
<div id="solution-5" class="section level3">
<h3>Solution</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Cor <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix) {</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> z[ , <span class="dv">1</span>] </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> z[ix, <span class="dv">2</span>] </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)])</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> z[, <span class="dv">1</span>];y <span class="ot">&lt;-</span> z[, <span class="dv">2</span>]</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Cor, <span class="at">R =</span> <span class="dv">999</span>, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;ASL =&#39;</span> ,<span class="fu">mean</span>(tb <span class="sc">&gt;=</span> boot.obj<span class="sc">$</span>t0), <span class="st">&#39;p.value =&#39;</span>, <span class="fu">cor.test</span>(x, y)<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>## ASL = 0.029 p.value = 0.06069778</code></pre>
<p>The ASL is not equal to p-value.When <span class="math inline">\(\alpha = 0.05\)</span>,ASL = 0.029 <span class="math inline">\(&lt; \alpha\)</span>, it is depent;but p-value = 0.0606978 <span class="math inline">\(&gt; \alpha\)</span>, it is indepent.</p>
</div>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</p>
<p>(1)Unequal variances and equal expectations</p>
<p>(2)Unequal variances and unequal expectations</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
<div id="solution-6" class="section level3">
<h3>Solution</h3>
<p><strong>Answer (1)</strong></p>
<p><span class="math inline">\(X\sim N(0,0.8^2)\)</span> ,<span class="math inline">\(Y\sim N(0,0.5^2)\)</span></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes, k) {</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z, <span class="dv">0</span>);</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, sizes, k){</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Tn, <span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k =</span> k)</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>    p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts <span class="sc">&gt;=</span> ts[<span class="dv">1</span>])</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">statistic =</span> ts[<span class="dv">1</span>], <span class="at">p.value =</span> p.value)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>p_NN <span class="ot">&lt;-</span> p_energy <span class="ot">&lt;-</span> p_ball <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p, <span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.7</span>), <span class="at">ncol=</span>p)</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p, <span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.5</span>), <span class="at">ncol=</span>p)</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>   p_NN[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z, N, k)<span class="sc">$</span>p.value</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>   p_energy[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes =</span> N, <span class="at">R =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>   p_ball[i] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations =</span> <span class="dv">999</span>, <span class="at">seed =</span> i <span class="sc">*</span> <span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;pow_NN = &#39;</span>, <span class="fu">mean</span>(p_NN <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_energy = &#39;</span>, <span class="fu">mean</span>(p_energy <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_ball = &#39;</span>, <span class="fu">mean</span>(p_ball <span class="sc">&lt;</span> alpha))</span></code></pre></div>
<pre><code>## pow_NN =  0.29 pow_energy =  0.35 pow_ball =  0.82</code></pre>
<p>Ball could be more powerful.</p>
<p><strong>Answer (2)</strong></p>
<p><span class="math inline">\(X\sim N(0.1,0.6^2)\)</span> ,<span class="math inline">\(Y\sim N(0.3,0.85^2)\)</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes, k) {</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z, <span class="dv">0</span>);</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, sizes, k){</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Tn, <span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k =</span> k)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts <span class="sc">&gt;=</span> ts[<span class="dv">1</span>])</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">statistic =</span> ts[<span class="dv">1</span>], <span class="at">p.value =</span> p.value)</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a> p_NN <span class="ot">&lt;-</span> p_energy <span class="ot">&lt;-</span> p_ball <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p, <span class="at">mean =</span> <span class="fl">0.1</span>,<span class="at">sd =</span> <span class="fl">0.55</span>), <span class="at">ncol=</span>p)</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p, <span class="at">mean =</span> <span class="fl">0.3</span>,<span class="at">sd =</span> <span class="fl">0.7</span>), <span class="at">ncol=</span>p)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>   p_NN[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z, N, k)<span class="sc">$</span>p.value</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>   p_energy[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes =</span> N, <span class="at">R =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>   p_ball[i] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations =</span> <span class="dv">999</span>, <span class="at">seed =</span> i <span class="sc">*</span> <span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;pow_NN = &#39;</span>, <span class="fu">mean</span>(p_NN <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_energy = &#39;</span>, <span class="fu">mean</span>(p_energy <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_ball = &#39;</span>, <span class="fu">mean</span>(p_ball <span class="sc">&lt;</span> alpha))</span></code></pre></div>
<pre><code>## pow_NN =  0.42 pow_energy =  0.81 pow_ball =  0.84</code></pre>
<p>Ball could be more powerful.</p>
<p><strong>Answer (3)</strong></p>
<p><span class="math inline">\(X\sim t(1)\)</span>, <span class="math inline">\(Y1\sim N(0.3,1.5^2)~~~~~~~Y2\sim N(0.5,2^2)\)</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes, k) {</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z, <span class="dv">0</span>);</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, sizes, k){</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>    boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Tn, <span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k =</span> k)</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>    ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts <span class="sc">&gt;=</span> ts[<span class="dv">1</span>])</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">statistic =</span> ts[<span class="dv">1</span>], <span class="at">p.value =</span> p.value)</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a> p_NN <span class="ot">&lt;-</span> p_energy <span class="ot">&lt;-</span> p_ball <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rt</span>(n1<span class="sc">*</span>p, <span class="at">df =</span> <span class="dv">1</span>), <span class="at">ncol =</span> p)</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rnorm</span>(n2, <span class="at">mean =</span> <span class="fl">0.3</span>, <span class="at">sd =</span> <span class="fl">1.5</span>),<span class="fu">rnorm</span>(n2, <span class="at">mean =</span> <span class="fl">0.5</span>, <span class="at">sd =</span> <span class="dv">2</span>))</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>   p_NN[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z, N, k)<span class="sc">$</span>p.value</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>   p_energy[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes =</span> N, <span class="at">R =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>   p_ball[i] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations =</span> <span class="dv">999</span>, <span class="at">seed =</span> i <span class="sc">*</span> <span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;pow_NN = &#39;</span>, <span class="fu">mean</span>(p_NN <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_energy = &#39;</span>, <span class="fu">mean</span>(p_energy <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_ball = &#39;</span>, <span class="fu">mean</span>(p_ball <span class="sc">&lt;</span> alpha))</span></code></pre></div>
<pre><code>## pow_NN =  0.68 pow_energy =  0.92 pow_ball =  0.83</code></pre>
<p>energy could be more powerful.</p>
<p><strong>Answer (4)</strong></p>
<p><span class="math inline">\(X\sim N(0,0.75^2)\)</span> ,<span class="math inline">\(Y\sim N(0,0.75^2)\)</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(energy)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Ball)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>Tn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, ix, sizes, k) {</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> sizes[<span class="dv">1</span>]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> sizes[<span class="dv">2</span>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">is.vector</span>(z)) z <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(z, <span class="dv">0</span>);</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    z <span class="ot">&lt;-</span> z[ix, ];</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    NN <span class="ot">&lt;-</span> <span class="fu">nn2</span>(<span class="at">data=</span>z, <span class="at">k=</span>k<span class="sc">+</span><span class="dv">1</span>) </span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    block1 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>n1, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    block2 <span class="ot">&lt;-</span> NN<span class="sc">$</span>nn.idx[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    i1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block1 <span class="sc">&lt;</span> n1 <span class="sc">+</span> .<span class="dv">5</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    i2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(block2 <span class="sc">&gt;</span> n1<span class="fl">+.5</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>   (i1 <span class="sc">+</span> i2) <span class="sc">/</span> (k <span class="sc">*</span> n)</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>eqdist.nn <span class="ot">&lt;-</span> <span class="cf">function</span>(z, sizes, k){</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    boot.obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> z, <span class="at">statistic =</span> Tn, <span class="at">R =</span> R, <span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">sizes =</span> sizes,<span class="at">k =</span> k)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    ts <span class="ot">&lt;-</span> <span class="fu">c</span>(boot.obj<span class="sc">$</span>t0, boot.obj<span class="sc">$</span>t)</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts <span class="sc">&gt;=</span> ts[<span class="dv">1</span>])</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">statistic =</span> ts[<span class="dv">1</span>], <span class="at">p.value =</span> p.value)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">200</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1 <span class="sc">+</span> n2</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(n1, n2)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a> p_NN <span class="ot">&lt;-</span> p_energy <span class="ot">&lt;-</span> p_ball <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>   x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n1<span class="sc">*</span>p, <span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.8</span>), <span class="at">ncol=</span>p)</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>   y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n2<span class="sc">*</span>p, <span class="at">mean =</span> <span class="dv">0</span>,<span class="at">sd =</span> <span class="fl">0.5</span>), <span class="at">ncol=</span>p)</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>   z <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x,y)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>   p_NN[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.nn</span>(z, N, k)<span class="sc">$</span>p.value</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>   p_energy[i] <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(z, <span class="at">sizes =</span> N, <span class="at">R =</span> R)<span class="sc">$</span>p.value</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>   p_ball[i] <span class="ot">&lt;-</span> <span class="fu">bd.test</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">num.permutations =</span> <span class="dv">999</span>, <span class="at">seed =</span> i <span class="sc">*</span> <span class="dv">12345</span>)<span class="sc">$</span>p.value</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;pow_NN = &#39;</span>, <span class="fu">mean</span>(p_NN <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_energy = &#39;</span>, <span class="fu">mean</span>(p_energy <span class="sc">&lt;</span> alpha), <span class="st">&#39;pow_ball = &#39;</span>, <span class="fu">mean</span>(p_ball <span class="sc">&lt;</span> alpha))</span></code></pre></div>
<pre><code>## pow_NN =  0.42 pow_energy =  0.52 pow_ball =  0.4</code></pre>
<p>energy could be more powerful.</p>
</div>
</div>
<div id="exercise-9.3" class="section level2">
<h2>Exercise 9.3</h2>
<p>Repeat Example <span class="math inline">\(9.1\)</span> for the target distribution Rayleigh(<span class="math inline">\(\sigma = 2\)</span>). Compare the performance of the Metropolis-Hastings sampler for Example <span class="math inline">\(9.1\)</span> and this problem. In particular, what differences are obvious from the plot corresponding to Figure <span class="math inline">\(9.1\)</span>?</p>
<div id="solution-7" class="section level3">
<h3>Solution</h3>
<p>Proposal distribution: <span class="math inline">\(N(X_t,\sigma^2)\)</span>,target pdf: <span class="math inline">\(f(x)=\frac{1}{\pi(1+x^2)}\)</span></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21068</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mu, sigma)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)     </span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  r1 <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  r2 <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1001</span>      <span class="co">#discard the burn-in sample</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[b<span class="sc">:</span>m]</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">10</span>)</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>QR <span class="ot">&lt;-</span> <span class="fu">qt</span>(a, <span class="at">df=</span><span class="dv">1</span>)  <span class="co">#quantiles of Cauchy</span></span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, a)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(QR, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>)</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(QR, <span class="fu">f</span>(QR))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-9.8" class="section level2">
<h2>Exercise 9.8</h2>
<p>This example appears in <span class="math inline">\([40]\)</span>. Consider the bivariate density <span class="math display">\[f(x, y) \propto \dbinom{n}{k} y^{x+a−1}(1 − y)^{n−x+b−1}, x = 0, 1, \ldots , n, 0 \leq y \leq 1.\]</span> It can be shown that for fixed <span class="math inline">\(a, b, n,\)</span> the conditional distributions are Binomial<span class="math inline">\((n, y)\)</span> and Beta<span class="math inline">\((x+a, n−x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<div id="solution-8" class="section level3">
<h3>Solution</h3>
<p>Given <span class="math inline">\(a=b=1,n=25\)</span>,<span class="math inline">\(f(x_1|x_2)\sim binom(n,x_2),f(x_2|x_1)\sim beta(x_1+a,n-x_1+b)\)</span></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21068</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, <span class="fl">0.5</span>)  <span class="co">#initialize</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">50</span>)   <span class="co">#initialize</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow=c(1, 2))</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">2</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAACsAAFUAKysAK4AAVaorAAArACsrAFUrKysrgNRVAABVACtVVVVVqqpVqv+AKwCAVQCAgFWA1P+qVQCq/6qq///UgCvUgIDU/9TU///fU2v/qlX/1ID//6r//9T///8Y5647AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKJklEQVR4nO2dC3eruBlFz51J0mkybdzGHdrYSfj/v7IWbxsDnx5wDoa95k6ILcTRXiBjIQjynVHADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqINm6fvtNc+Ap09eGEXQLB2fPr9envPjMy+MIqgXvt/e8zMu/377ixhHD9QLTtDxIifbBV2BZun4/P329Pn9th9iV6BZ+n7Dr4+fw+7nGiSubjV4C/o5vKYQlKCORYB3QddJL7hdNvAvmOTz3bxdNvAueOmjS0I89Q/t08n9534WP8pf+vRebl4YWKFXuC13s1RvuYlynXi6ds+CPtWVkZqYVTs6pspXTk0bmjea8vmp/T2/Wq+zQlHpqS7UrtYR1Ea5lmRut7mgT3WnKnt+I6hq0Ok0IKh6r/7RrF6LaBrZraBZqdXSrpq3dV3XYG53p+DlIHv6PMZ9lqHOfy2o0/YUgq4qGBXUfTdW0PnXR+bOpKMMoWlAvV/3UqYXdC3gZsvJBLnzoIugyO9iFkGnG0E3e1pXUL/5o4La43hI0ClckDsPcoLiPu3Ngk5dJTZBbfvuqbEIqqsJElTvQceoEbN5BdXNowiq+qAMUSfU14L6Ou43aR2CylPFXx8xfrqC+sGXEnSaSVAKVASNvTSnoCPw/HO47GhDx2GooJtymoKKQ2y0iy46cTyXV0DWIqhfJlDQudgtspFOqBgyOhcFsgGRiQTdXyu//7JtO50yYYLqAbORj/liyKg8Txo6W3pgQfWA2ciJ4uJ7kL+FWfegcrh+qOn1e0UfNDg++8CCLn2Qa/R59ERoqU+xiRYGvdWWCRDUDCcGjigmE2SCtAclYRdUMTQoMiRovEnrEFQfZgkG7X1buwpBP4cUM4P8BZnbZSq9wHnQLmhAkOnSc/ERP3YYPrCg/Otvk0NBGSqJZ3ieKIY32a/0rIJepjrpzk7m+1UjvMnpKwoUZJgZ1OmmfL+sJmhXMgIFGTrpFexBpo2FCbJ00s2IPrcPiiRQkKWTbk4mB0+ZHlhQ1PSXLQhKwy7IUl1A5vQaRjYWJijhIRaQOb2GkY2FCaqInKlYVuefeQYPwxuLEhR5M0ugoEWJFJRs+osskYKSTaCSJU5Q5M0sDyxo8iR564LSsAsaqCV80H55QgVNDqfaq2MrGCdU0DHdzSxsBeMECoqcQb4FQcTLPosSKCjN3aoPLKiagrcLGhJEHVFclEBBadgF7YIMfL0M9lbbFmSYqLdtQfX1wn0PGsQ9/mSzgmxT8I6/PjYqyDoFL8PrNgWZv4t9vfy+SUH2p7/8HIa/lDywINPsDmN1bAXjBAuanILXId1E8uUJFBQ13LGFMel9wGxCUMpHdLEVjBMoyNRJzzWRfFECBVkGzGabSL4ogYIMzDcNeKQ16auaT9B8E8mnW5WwqmBBxYnQ2C2rG9+Dyn5l9Okvs00kn25VwqoCBdW7x9ht4bNNJJ9uVcKqAgUZHixgri5do4QEmfagLQuy9EHbFjT9KbZ1QSnYBW1U0OzP7ohuVbqqukHNLXJYnv6yZUGW5wfJCjKVihS06hPFJQQZnmFGEGSsawlBhqfgjdRyf9A+3lScoPzeb8GCDM9RtFY3kduDu49SnDIx8HK0oBTcCIo2tAuaIFJQ3n0/VtAM92ooCuq12yxohns1HkrQHPdqPJig9Jee428QHxB0W+8Sgua4V8NbUHdlNUFz3KshIqiqNPoQMwx3eF6bfyhBFnyvzU+0dlxQvj5B3ldWBwUNmRoRlNMFTc+T9r42v5yg+xWmFXR8+syexyaJJ9uD8sFjTVmQO1E8uz9+NPZEcs9r8zcmeoJ6zSpX7rjoCcrvrriMoPf864+/in+DeF6bHxOU32vtkKBcQJA7fr7//BgXZKzujqC8bX7F/ILynqA8QlAx9fn4mnTQ3igo7zapeX1SUN6aut/9Jxbknj11OYRs3+mnJpJXka73h7ULiqA3Jt280xF081bnhaaN7euNoDyv1+4Kyqv/5e3L3Y7m6s2O9oB29wv+N74PWgHwLZhVZ4g/hwQjiisAngXdFWd3ReyMoTOcAuOX1RUAv4LFYNDlTCgbnx9k/bK6AuBXsBhv/Tn8HaODZpavGqvBV5D7DnEcPbxMX1a7lRq2q1HEsH4laOIc0bAHmUMpFTGsXwmaGpWe/rJqDqVUxLC+UZD1YYuGUEpFDOtbBXlVupoihvWTzVHsVrqaIrOuH1qpUpFZ1w+tVKnIrOuHVqpUZNb1Hx6wA6gDdgB1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUQfIazxE335eXDZoa+gvTZEA5ch5VSwt8V5jCXaMNvTP4XAx2NzX0F6ZxNwQWM76jaukA/2aMUl4aChvd/n5zgpoa+guWzT8PrRyYDJ7lpygngYb9kbLs6V8XQU0N/YXpKhpBUbV0gV/xScpn6QXdOn1Z1fVBTQ39BUMl9SEWV0sH+BWfpDzIQzohdwgUE0zqGvoLpgBlTxxZSwv8ik/nCxbkrmbHC3K3BX69vOoKCj7EihWjD7G2x1E9xII76ay6bvke1b02u4lsJx3zMV/uQVEf0KWFy24i+zEfdaJYnklHneLVfZDsiWJxrER+1Whq6C8YqkA1zTKqlhb4rrA1wA6gDtgB1AE7gDpgB1AH7ADqgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7QI/e/ILIv6YTCYjbvs8uaIJd0AQXH99v/3wr58u7GSv/doKyclaLmyCW5un7VrDgtmwUgi5O3IReNx3qjOoXNy/KTROLexSmL1hwWzYKQa/FbLpyQt2xeqGYgHn+7T9/LnrEYcmNmSgEvReP7CmnpDZTeAtfx/HnrCUHi27NQkdQ1giqp8Am+tsEHmDRrVkY3oMcP4d/pPgLMnaw5MZMdARVU5urFwqyp/8dlvwQ0xZU3ZpSfYqVvfV75B8Z9AULbstGV9D1eZB74HUx03zJbhoLbmuVgB1AHbADqAN2AHXADqAO2AHUATuAOmAHUAfsAOqAHUAdsAOoA3YAdcAOoA7YAdQBO4A6YAdQB+wA6oAdQB2wA6gDdgB1wA6gDtgB1AE7gDpgB1Dn/4yShQ+GUJnyAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="problem-3" class="section level2">
<h2>Problem 3</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>.</p>
<div id="solution-9" class="section level3">
<h3>Solution</h3>
<p><strong>9.3</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(r.hat)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="dv">1</span><span class="sc">/</span>(pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))}</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>cauthy.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, X1, sigma)</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>       xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>       y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)     <span class="co">#candidate point</span></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>       r1 <span class="ot">&lt;-</span> <span class="fu">f</span>(y) <span class="sc">*</span> <span class="fu">dnorm</span>(xt, y, sigma)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>       r2 <span class="ot">&lt;-</span> <span class="fu">f</span>(xt) <span class="sc">*</span> <span class="fu">dnorm</span>(y, xt, sigma)</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>       r <span class="ot">&lt;-</span> r1 <span class="sc">/</span> r2</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>       <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> r) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>       }</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>      <span class="co">#parameter of proposal distribution</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>   X[i, ] <span class="ot">&lt;-</span> <span class="fu">cauthy.chain</span>(sigma, n, x0[i])</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>    psi[i, ] <span class="ot">&lt;-</span> psi[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>9.8</strong></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>    psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>    v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>    r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(r.hat)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>binombeta.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(N, p, alpha, beta, n, a, b) {</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) </span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    X[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, p)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    X[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, alpha, beta)</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>       x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>       X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>       x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>       X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X)</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>          <span class="co">#number of chains to generate</span></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">15000</span>      <span class="co">#length of chains</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>    <span class="co">#burn-in length</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">60</span>, <span class="dv">40</span>, <span class="dv">20</span>), <span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>m)</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>m)</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">binombeta.chain</span>(m, X0[i,<span class="dv">1</span>], X0[i,<span class="dv">2</span>], X0[i,<span class="dv">3</span>], n, a, b)</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> Z[ ,<span class="dv">1</span>]</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>  Y[i, ] <span class="ot">&lt;-</span> Z[ ,<span class="dv">2</span>]</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>    psi[i, ] <span class="ot">&lt;-</span> psi[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m)</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>psj <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psj))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    psj[i, ] <span class="ot">&lt;-</span> psj[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psj))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psj[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-11.3" class="section level2">
<h2>Exercise 11.3</h2>
<p><strong>(a)</strong> Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[\sum_{k=0}^{\infty} \frac{(-1)^k}{k!2^k}\frac{\|a\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\big(\frac{d+1}{2}\big)\Gamma\big(k+\frac{3}{2}\big)}{\Gamma\big(k+\frac{d}{2}+1\big)}\]</span> where <span class="math inline">\(d \geq 1\)</span> is an integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large <span class="math inline">\(k\)</span> and <span class="math inline">\(d\)</span>. (This sum converges for all <span class="math inline">\(a \in R^d\)</span>).</p>
<p><strong>(b)</strong> Modify the function so that it computes and returns the sum.</p>
<p><strong>(c)</strong> Evaluate the sum when <span class="math inline">\(a = (1, 2)^T\)</span> .</p>
<div id="solution-10" class="section level3">
<h3>Solution</h3>
<p><strong>(a)</strong></p>
<p>Set <span class="math inline">\(A_k = \frac{(-1)^k}{k!2^k}\frac{\|a\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\big(\frac{d+1}{2}\big)\Gamma\big(k+\frac{3}{2}\big)}{\Gamma\big(k+\frac{d}{2}+1\big)}\)</span>.</p>
<p>The <span class="math inline">\(k^{th}\)</span> term in the formula is <span class="math inline">\(A_{k-1}\)</span>, but the function is similar.So it is OK to write the function to compute the <span class="math inline">\(A_k\)</span>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>vector_length <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>   temp <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(x)) {</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>         temp <span class="ot">&lt;-</span> temp <span class="sc">+</span> x[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    vlength <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(temp)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(vlength)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>A_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k, x) {</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>k<span class="sc">/</span><span class="fu">factorial</span>(k)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="fu">vector_length</span>(x)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> (c<span class="sc">^</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))<span class="sc">/</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>))</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> a <span class="sc">*</span> e <span class="sc">*</span> b</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(f)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>(b)</strong></p>
<p>The function is to compute <span class="math inline">\(\sum_{k=0}^{\infty} A_k\)</span>.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>aksum <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  aksum <span class="ot">&lt;-</span> <span class="fu">A_k</span>(<span class="dv">0</span>, x)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(<span class="fu">A_k</span>(i, x) <span class="sc">-</span> <span class="fu">A_k</span>(i<span class="dv">-1</span>, x)) <span class="sc">&gt;</span> <span class="fl">1e-1000</span>) {</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>      aksum <span class="ot">&lt;-</span> aksum <span class="sc">+</span> <span class="fu">A_k</span>(i, x)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>      i <span class="ot">=</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">m=</span>aksum, <span class="at">k=</span>i))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>(c)</strong></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aksum</span>(x)<span class="sc">$</span>m</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[\frac{2\Gamma\big(\frac{k}{2}\big)}{\sqrt{\pi(k-1)}\Gamma\big(\frac{k-1}{2}\big)}\int_0^{c_{k-1}}{(1+\frac{u^2}{k-1})^{-k/2}}du
\\=\frac{2\Gamma\big(\frac{k+1}{2}\big)}{\sqrt{\pi k}\Gamma\big(\frac{k}{2}\big)}\int_0^{c_k}{(1+\frac{u^2}{k})^{-(k+1)/2}}du\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[c_k=\sqrt{\frac{a^2 k}{k+1-a^2}}\]</span> Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<div id="solution-11" class="section level3">
<h3>Solution</h3>
<p>Let <span class="math display">\[T_{k-1}(a)=\frac{2\Gamma\big(\frac{k}{2}\big)}{\sqrt{\pi(k-1)}\Gamma\big(\frac{k-1}{2}\big)}\int_0^{c_{k-1}}{(1+\frac{u^2}{k-1})^{-k/2}}du=P(0&lt;t(k-1)&lt;c_{k-1})=P(t(k-1)&lt;c_{k-1})-\frac{1}{2} \\T_k(a)=\frac{2\Gamma\big(\frac{k+1}{2}\big)}{\sqrt{\pi k}\Gamma\big(\frac{k}{2}\big)}\int_0^{c_k}{(1+\frac{u^2}{k})^{-(k+1)/2}}du=P(0&lt;t(k)&lt;c_{k})=P(t(k)&lt;c_{k})-\frac{1}{2}\]</span></p>
<p>We can see <span class="math inline">\(T_{k-1}(a)=1/2-S_{k-1}(a),T_{k}(a)=1/2-S_{k}(a)\)</span>.</p>
<p>So <span class="math inline">\(T_{k-1}=T_{k} \Leftrightarrow S_{k-1}=S_k\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">25</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)) {</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  solution[i]<span class="ot">=</span><span class="fu">uniroot</span>(</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(a) {<span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k[i]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span>(k[i]<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k[i]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k[i])<span class="sc">/</span>(k[i]<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)),<span class="at">df=</span>k[i])},</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>     <span class="fu">c</span>(<span class="fl">1e-4</span>, <span class="fu">sqrt</span>(k[i])<span class="sc">-</span><span class="fl">1e-4</span>))<span class="sc">$</span>root</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(k, solution)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(x, <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;solution&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533549</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562768</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584421</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601192</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614517</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625391</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634409</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642004</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648565</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654167</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659099</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663452</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667288</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670736</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673840</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676588</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679139</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681461</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">4.795731</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">4.898879</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">4.999900</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">9.999900</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">22.360580</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">31.622677</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="problem-3-1" class="section level2">
<h2>Problem 3</h2>
<p>Suppose <span class="math inline">\(T1, \dots, Tn\)</span> are <span class="math inline">\(i.i.d.\)</span> samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i \leq \tau ) + \tau I(T_i &gt; \tau), i = 1, \dots, n.\)</span> Suppose <span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85\]</span> Use the <span class="math inline">\(E-M\)</span> algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data <span class="math inline">\(MLE\)</span> (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
<div id="solution-12" class="section level3">
<h3>Solution</h3>
<p><font size="4"><strong>Observed data MLE</strong></font></p>
<p>Suppose the number of observed data is <span class="math inline">\(n\)</span>,and the number of data which is smaller than <span class="math inline">\(\tau\)</span> is <span class="math inline">\(r\)</span>.We set <span class="math inline">\(x_1,\dots,x_r \leq \tau,x_{r+1},\dots,x_n&gt;\tau\)</span>.Then the likelihood function is <span class="math display">\[L_n(x_1,x_2,\dots,x_r,x_{r+1},\dots,x_n;\lambda)=\frac{n!}{(n-r)!}\prod_{i=1}^{r}(\lambda e^{-\lambda x_i})(e^{-\lambda \tau})^{n-r}
\\\Rightarrow logL_n(x_1,x_2,\dots,x_r;\lambda)=log(\frac{n!}{(n-r)!})+rlog\lambda-\lambda(\sum_{i=1}^rx_i+(n-r)\tau)
\\\Rightarrow \hat{\lambda}=\frac{r}{\sum_{i=1}^rx_i+(n-r)\tau}\]</span></p>
<p>In this case ,<span class="math inline">\(r=7,n=10,\tau=1\)</span>,so the estimated value is <span class="math inline">\(28/27\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(y <span class="sc">&lt;</span> tau))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>mlogL <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">lambda=</span><span class="dv">1</span>) {</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="fu">factorial</span>(n)<span class="sc">/</span><span class="fu">factorial</span>(n<span class="sc">-</span>r)) <span class="sc">-</span> r<span class="sc">*</span><span class="fu">log</span>(lambda) <span class="sc">+</span> lambda<span class="sc">*</span>(<span class="fu">sum</span>(y)))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>L.MLE <span class="ot">&lt;-</span> <span class="fu">mle</span>(mlogL)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>L.MLE</span></code></pre></div>
<pre><code>## 
## Call:
## mle(minuslogl = mlogL)
## 
## Coefficients:
##   lambda 
## 1.037039</code></pre>
<p><font size="4"><strong>Complete data likelihood</strong></font></p>
<p><strong>E-step:</strong></p>
<p><span class="math display">\[L_c(x_1,x_2,\dots,x_n;\lambda)=\prod_{i=1}^{n}(\lambda e^{-\lambda x_i})=\lambda ^{n}e^{-\lambda\sum_{i=1}^nx_i}
\\\Rightarrow logL_c(x_1,x_2,\dots,x_n;\lambda)=nlog\lambda-\lambda\sum_{i=1}^nx_i\]</span> <span class="math display">\[E_{\lambda_0}[logL_c|x_1,\dots,x_r,x_{r+1},\dots,x_n]=nlog\lambda-\lambda\sum_{i=1}^rx_i-\lambda\sum_{i=r+1}^nE_{\lambda_0}[x_i|x_i&gt; \tau]=nlog\lambda-\lambda\sum_{i=1}^rx_i-\lambda(n-r)(\frac{1}{\lambda_0}+\tau)\]</span> where <span class="math display">\[E_{\lambda_0}[x_i|x_i&gt;\tau]=\int_{\tau}^{\infty}{xe^{-\lambda_0(x-\tau)}}dx=\frac{1}{\lambda_0}+\tau\]</span></p>
<p><strong>M-step:</strong></p>
<p><span class="math display">\[\lambda_1=argmaxE_{\lambda_0}[logL_c]=\frac{n}{\sum_{i=1}^rx_i+(n-r)(\frac{1}{\lambda_0}+\tau)}
\\\Rightarrow\lambda_{\infty}=\frac{n}{\sum_{i=1}^rx_i+(n-r)(\frac{1}{\lambda_\infty}+\tau)}
\\\Rightarrow\hat{\lambda}=\frac{r}{\sum_{i=1}^rx_i+(n-r)\tau}\]</span></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>      r <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(y <span class="sc">&lt;</span> tau))</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>      L.old <span class="ot">&lt;-</span> L</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>      L <span class="ot">&lt;-</span> n<span class="sc">/</span>(<span class="fu">sum</span>(y) <span class="sc">+</span> (n<span class="sc">-</span>r)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>L.old))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">abs</span>((L <span class="sc">-</span> L.old)<span class="sc">/</span>L.old) <span class="sc">&lt;</span> <span class="fl">1e-8</span>) <span class="cf">break</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;L.EM =&quot;</span>, L)</span></code></pre></div>
<pre><code>## L.EM = 1.037037</code></pre>
</div>
</div>
<div id="exercise-11.1.2.1" class="section level2">
<h2>Exercise 11.1.2.1</h2>
<ol style="list-style-type: decimal">
<li>Why are the following two invocations of lapply() equivalent?</li>
</ol>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>trims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rcauchy</span>(<span class="dv">100</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, <span class="cf">function</span>(trim) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4.158182
## 
## [[2]]
## [1] 0.269774
## 
## [[3]]
## [1] 0.1436236
## 
## [[4]]
## [1] 0.2697976</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(trims, mean, <span class="at">x =</span> x)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4.158182
## 
## [[2]]
## [1] 0.269774
## 
## [[3]]
## [1] 0.1436236
## 
## [[4]]
## [1] 0.2697976</code></pre>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>In the first statement each element of <code>trims</code> is explicitly supplied to <code>mean()</code>’s second argument.</p>
<p>In the latter statement this happens via positional matching, since <code>mean()</code>’s first argument is supplied via name in <code>lapply()</code>’s third argument (<code>...</code>).</p>
</div>
</div>
<div id="exercise-11.1.2.5" class="section level2">
<h2>Exercise 11.1.2.5</h2>
<ol start="5" style="list-style-type: decimal">
<li>For each model in the previous two exercises, extract R2 using the function below.</li>
</ol>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p><strong>For the models in exercise 3:</strong></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula =</span> x, <span class="at">data =</span> mtcars))</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(formulas))</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)){</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  f[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(a, rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(f, rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p><strong>the models in exercise 4:</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(bootstraps), <span class="cf">function</span>(i) {<span class="fu">lm</span>(mpg <span class="sc">~</span> disp,<span class="at">data=</span>bootstraps[[i]])})</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="fu">length</span>(bootstraps))</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)){</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  f[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(a, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.8150775 0.6557605 0.6955273 0.8206330 0.7975696 0.5995222 0.7319104
##  [8] 0.7509501 0.6917722 0.7046225</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(f, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.8150775 0.6557605 0.6955273 0.8206330 0.7975696 0.5995222 0.7319104
##  [8] 0.7509501 0.6917722 0.7046225</code></pre>
</div>
</div>
<div id="exercise-11.2.5.1" class="section level2">
<h2>Exercise 11.2.5.1</h2>
<ol style="list-style-type: decimal">
<li>Use <span class="math inline">\(vapply()\)</span> to:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use <span class="math inline">\(vapply()\)</span> twice.)</p></li>
</ol>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p>As a numeric <code>data.frame</code> we choose <code>cars</code>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(cars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     speed      dist 
##  5.287644 25.769377</code></pre>
<p>And as a mixed <code>data.frame</code> we choose <code>mtcars</code>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mtcars[<span class="fu">vapply</span>(mtcars, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))], sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
</div>
</div>
<div id="exercise-11.2.5.7" class="section level2">
<h2>Exercise 11.2.5.7</h2>
<ol start="7" style="list-style-type: decimal">
<li>Implement <span class="math inline">\(mcsapply()\)</span>, a multicore version of <span class="math inline">\(sapply()\)</span>. Can you implement <span class="math inline">\(mcvapply()\)</span>, a parallel version of <span class="math inline">\(vapply()\)</span>? Why or why not?</li>
</ol>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p>Sorry,I don not know how to solve this question.</p>
</div>
</div>
<div id="problem" class="section level2">
<h2>Problem</h2>
<p><strong>Exercise 9.8</strong></p>
<p>This example appears in <span class="math inline">\([40]\)</span>. Consider the bivariate density <span class="math display">\[f(x, y) \propto \dbinom{n}{k} y^{x+a−1}(1 − y)^{n−x+b−1}, x = 0, 1, \ldots , n, 0 \leq y \leq 1.\]</span> It can be shown that for fixed <span class="math inline">\(a, b, n,\)</span> the conditional distributions are Binomial<span class="math inline">\((n, y)\)</span> and Beta<span class="math inline">\((x+a, n−x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<p><strong>(1)</strong>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).</p>
<p><strong>(2)</strong>Compare the corresponding generated random numbers with pure R language using the function “qqplot”.</p>
<p><strong>(3)</strong>Compare the computation time of the two functions with the function “microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p><strong>(1)</strong></p>
<p>R function:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, n, a, b){</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">&lt;-</span> x0</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x1<span class="sc">+</span>a, n<span class="sc">-</span>x1<span class="sc">+</span>b)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Rcpp function:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix GibbsC(int N, NumericVector x0, int n, double a, double b) {</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="st">            NumericMatrix X(N,2);</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="st">            X(0, 0) = x0[1];</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="st">            X(0, 1) = x0[2];</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="st">            for(int i = 1; i &lt; N; i++)</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="st">            {</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="st">              double x2 = X(i-1, 1);</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="st">              X(i, 0) = rbinom(1, n, x2)[0];</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="st">              double x1 = X(i, 0);</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="st">              X(i, 1) = rbeta(1, x1+a, n-x1+b)[0];</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="st">            }</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a><span class="st">            return X;</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<p><strong>(2)</strong></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">21068</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span> b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">GibbsR</span>(N, x0, n, a, b)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">GibbsC</span>(N, x0, n, a, b)</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co">#par(mfrow = c(2, 2))</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Y[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">1</span>],Y[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;y1&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;y2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">1</span>],X[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="st">&quot;x1&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;x2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">1</span>],Y[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">&#39;R&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;cpp&#39;</span>,<span class="at">main=</span><span class="st">&#39;1&#39;</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAACsAAFUAK1UAK4AAVaorAAArACsrAFUrKysrVaorgNRVAABVACtVKwBVqv+AKwCA1P+qVQCqVSuq1NSq///UgCvUgFXUqoDU////qlX/1ID//6r//9T///8a52MXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIn0lEQVR4nO2djXacNhCFSZq4P3Hbzbam9drL+z9mFiRAsIyuBKOfje93ehKfMoy0n2EQWkGajnhpSnegdigIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAAwg6N19ey7VevaDrPw0Fefj/r4aCPLRN8+mJgmTa5pd/TxQk898fr1cK8kNBAAoCUBCAggAUBKAgAAUBKKhuKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARQFtQ8DKUE6aZTxVgZ/qSgDQY75s8moqMfRlAz/dkUEBR/amdnEjT9F7Ofcjcqwx4y/V+2DlGQi6Nk8kNBM/bcakwdGC9gFDQxCVqcWRQ0MQpqFmcWBQ2Mo8Lh1Orc7lFQjx0b2vHHYhBCQd1ibHjXMQrqZkFbI+cPL2goO91UfChohXtnujku/OCC5pNrPI62I4JThXI9mUvC5xeVdMnwVR83IjhVIG3zzfxwGX84lC4NqPrYqOB0EU1fT5OWVnhKsrwgWH3msOB8obw//z3+eBFOsuKCcPVx44IThvEIRxCuPm5ccMJA2sYeQlXWoMW8GOpMoqvY+7O5ionPaRcUtDkv5o0OTqtIOUHuvJi3+rjhwXmPUsGkvSMo5FMlEtTeFAxlqK3qKuYOfQInVBMV6U/fb2Xoa1eZoMXQJ3BGPuFl/nq6leiaBDlDn/CvlZMOFM9fXmsU1AUVn8VOmoGdM1A8f61F0Lr6lBU0nVi34VAdggJvvIQ9dQMHxqH09VSFoGX1iRpkfIyB4q7q4+6qGVgkna+lvdXH7q4eWCSdv6F91WfeXzewSDrQzq7q4ybQDCySDrSzq/q4CTQDi6TbbGJjOdSOLOqBRdIJLYRP+3jT6AYWSSc1sF4OtTePZmCRdFID6+VQe/NoBhZJJzUQPq3hz6MZWCTdKrm4HGpHrh2Bw4z8wdemphRkx4ZR0z7eZJGBl0/fOzNpmKPdvannEbRGtpjA62maDdvRXIZJ+3nwrPF7iBf0/qc5dKQvlZXbjUwbtCAhKmN04HgESV8qK7cbnfXInamQMjLwMkyGTd8uJ243PmnoV4IxOWMCx2+Vveuj9NqNT6pVfdycmoFF0o1JNavPmFM7sEg6J6ta9ZlTxgZWO1DUrT5jzujAegeKutVnzBkbeGigGN9ucMJ5ZkM3b3RgnQPFBNVnThwXWOVAcRwh1nAEBQ0Ucy8kd6tPaUEhA8WcC8ndyR/l1FHZYprNuQzYFh/nLkwr85xfN7DLupDcjJqDl2TubCAysL/Ai+dOT8YjqOm66e4iyeBqhyAzADJLEAXyLCRfT/5UImg8f7zjoBwLyRdDnwTVZ24lLnA8f6TFdcrt+jNMxSdB9XGaiQs058/bk6cIyVn05qRt9Vl1Tp09Rfrt6fYBj92rHvxITvVRyOZvSj0wQzq3+iQrPk5buoFd0GD7yGdaVp+kXyGlOoLExa370t3vm+PkmhpTDhy4njyjpPh0zn75qk8X10BkTy7gW6GdHyxn9Zlb1A1MmS5r9XGaVA1MmS5r9ZmaVA5Mmc49ryhotcM0L5ar+th21QPTpDPVOe5ZOBUeRJAzb5jv4IlrrLggU6ATdAW2rByons75SpCChMj082Le5nUDE7TbpJ8X87avG6jfbpN56LNuXzlQMd16QQIF3cfkvTMVOqEbqJZuNJPxzlTohW6gP0vEpH26BQkxVHoE1VB9uriWswqqovrMXdENVEhXR/WZ+6IbqJCujuoz9kU78Fi6xMuh4qlMkDOtUbz6GOoSZCfl66g+huoEFZrVEKlHUJblUPFUI6jwtI9ILYJs9Sk27SNSkaBqruwLahCUfUFCDBUIqujGa4PygpbVp57iY6lCUJ0nlyGRoLCnfRrnHVE7GslCGkFhT/vYslNr9TEkERT2rIY9aKqtPoYkguSnfdw5aefOvc6DZ6DsEWQKdGz6rKSqQSFP+zgvGKvWT6qrWMjTPvOL5eusPoZi46CapbgUFPQgFBIUlhRsP7b56O7HwnWSUtCx7RREQce2UxAFHdtOQRR0bPvPL+hngoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH0BV38L0Iz3z1KryF6++3Fl8NsFlIMa3O+ibtPm/09WKMuqH+x+cVj6O1Xr71hUYSUw27eTnE93fZo+w++ufu82duDO7QFmQUOZ/n343uR5cUszZJy2M1Ciren4XXPn1+2d582R75SXFvQ3A+B1uOu+TZ0Xsgxbval6I8cXxf6A8u3+z3qgobj1/NLOv8+VootjCAxh/l/vhTnzy++Ltw2gx6s0RZkzn25CL0/9ytDzlL/ho8l5xg2+1L063I8Xeg3gx6syS3IRklHWIggT4rLWKOF3edrV3Ahyn6Kmagn4WV6QaeYmMKs6xJ3d5d9iT1Yk71ImyjpSusr0t1S0H0KuwhX2r11C0/wtT73Zd703n+KyTkcf/cpxgWCwu7jZtCDNdkHikPH/UVazmGvYpsp5hc9b+4+b/b3YI3+rUYL3rl8vl1kxfPf/mKlHHbzZorWrBzr99va3dns7cEa3qwCKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYC6BY1v3dvz708rUbugYREL+sdLU/IQguC/f5uQhxDUncV3giXnIQTxCJKwZlrWIIHxKlbOT/WC+odPnsqdYA8hSH6tZQ4eQVB3Bgv3U/IQgszjFWV4CEHLRfJ5qVtQBVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYAfLBgA6r/5/3wAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(X[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">2</span>],Y[<span class="dv">1001</span><span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">xlab=</span><span class="st">&#39;R&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;cpp&#39;</span>,<span class="at">main=</span><span class="st">&#39;2&#39;</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The qqplot of random Numbers obtained by Rcpp and R is relatively close .</p>
<p><strong>(3)</strong></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">R=</span><span class="fu">GibbsR</span>(N, x0, n, a, b),<span class="at">Rcpp=</span><span class="fu">GibbsC</span>(N, x0, n, a, b))</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)])</span></code></pre></div>
<pre><code>##   expr      lq   median       uq
## 1    R 32.2550 34.15105 36.84475
## 2 Rcpp  2.6617  2.75535  2.89495</code></pre>
<p>The calculation time of Rcpp is significantly less than R, which indicates that Rcpp can effectively improve our calculation efficiency.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
